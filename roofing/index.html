<!DOCTYPE html>
<html>
<head>

    <meta charset="UTF-8">
    <title>Roofing project</title>
    <link rel="stylesheet" href="ol.css">
    <style>
    .map {
        width: 100%;
        height: 1200px;
    }
    </style>
    <script type="text/javascript">

        function loadScript(url, callback) {
            var script = document.createElement("script");
            script.type = "text/javascript";
            
            if (script.readyState) {  // IE
                script.onreadystatechange = function () {
                    if (script.readyState === "loaded" || script.readyState === "complete") {
                        script.onreadystatechange = null;
                        callback();
                    }
                };
            } else {  // Others
                script.onload = function () {
                    callback();
                };
            }
            
            script.src = url;
            document.getElementsByTagName("head")[0].appendChild(script);
        }

        // Load RequireJS asynchronously
        loadScript("scripts/require.min.js", function () {
            console.log('RequireJS loaded.');

            requirejs.config({
                paths: {
                    'ol': 'scripts/ol',
                    'condo1': 'condo/condo1',
                    'condo2': 'condo/condo2',
                    'condo3': 'condo/condo3',
                    'condo4': 'condo/condo4'
                },
                shim: {
                    ol: {
                        exports: 'ol'
                    }
                }                
            });

            // Load ECharts and the data module
            requirejs(['ol', 'condo1', 'condo2', 'condo3','condo4'], function(ol, condo1, condo2, condo3, condo4) {
                renderCharts(ol, condo1, condo2, condo3, condo4);
            });
        });


        function renderCharts(ol, condo1, condo2, condo3, condo4) {
            if (typeof ol === 'undefined') {
                console.error('Openlayers library not loaded.');
                return;
            }

            ol.proj.useGeographic();

            const image = new ol.style.Circle({
                radius: 5,
                fill: null,
                stroke: new ol.style.Stroke({color: 'red', width: 1}),
            });

            const styles = {
                'condo1': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'yellow',
                    lineDash: [4],
                    width: 3,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(0, 0, 255, 0.1)',
                    }),
                }),
                'condo2': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'green',
                    lineDash: [4],
                    width: 3,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(0, 0, 255, 0.1)',
                    }),
                }),
                'condo3': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'blue',
                    lineDash: [4],
                    width: 3,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(0, 0, 255, 0.1)',
                    }),
                }),
                'condo4': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'red',
                    lineDash: [4],
                    width: 3,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(0, 0, 255, 0.1)',
                    }),
                }),
                'Point': new ol.style.Style({
                    image: image,
                }),
                'LineString': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'green',
                    width: 1,
                    }),
                }),
                'MultiLineString': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'green',
                    width: 1,
                    }),
                }),
                'MultiPoint': new ol.style.Style({
                    image: image,
                }),
                'MultiPolygon': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'yellow',
                    width: 1,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(255, 255, 0, 0.1)',
                    }),
                }),
                'Polygon': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'blue',
                    lineDash: [4],
                    width: 3,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(0, 0, 255, 0.1)',
                    }),
                }),
                'GeometryCollection': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'magenta',
                    width: 2,
                    }),
                    fill: new ol.style.Fill({
                    color: 'magenta',
                    }),
                    image: new ol.style.Circle({
                    radius: 10,
                    fill: null,
                    stroke: new ol.style.Stroke({
                        color: 'magenta',
                    }),
                    }),
                }),
                'Circle': new ol.style.Style({
                    stroke: new ol.style.Stroke({
                    color: 'red',
                    width: 2,
                    }),
                    fill: new ol.style.Fill({
                    color: 'rgba(255,0,0,0.2)',
                    }),
                }),
            };

            const styleCondo1 = function (feature) {
                return styles['condo1'];
            };

            const vectorCondo1 = new ol.source.Vector({
                features: new ol.format.GeoJSON().readFeatures(condo1)
            });

            const vectorLayerCondo1 = new ol.layer.Vector({
                source: vectorCondo1,
                style: styleCondo1
            });

            const styleCondo2 = function (feature) {
                return styles['condo2'];
            };

            const vectorCondo2 = new ol.source.Vector({
                features: new ol.format.GeoJSON().readFeatures(condo2)
            });

            const vectorLayerCondo2 = new ol.layer.Vector({
                source: vectorCondo2,
                style: styleCondo2
            });

            const styleCondo3 = function (feature) {
                return styles['condo3'];
            };

            const vectorCondo3 = new ol.source.Vector({
                features: new ol.format.GeoJSON().readFeatures(condo3)
            });

            const vectorLayerCondo3 = new ol.layer.Vector({
                source: vectorCondo3,
                style: styleCondo3
            });

            const styleCondo4 = function (feature) {
                return styles['condo4'];
            };

            const vectorCondo4 = new ol.source.Vector({
                features: new ol.format.GeoJSON().readFeatures(condo4)
            });

            const vectorLayerCondo4 = new ol.layer.Vector({
                source: vectorCondo4,
                style: styleCondo4
            });

            const map = new ol.Map({
            layers: [
                new ol.layer.Tile({
                source: new ol.source.OSM(),
                }),
                vectorLayerCondo1,
                vectorLayerCondo2,
                vectorLayerCondo3,
                vectorLayerCondo4
            ],
            target: 'map',
            view: new ol.View({
                center: condo1.features[0].geometry.coordinates[0][0],
                zoom: 18,
            }),
            });

        }

    </script>

</head>

<body>
    <div id="map" class="map"></div>
</body>

</html>
